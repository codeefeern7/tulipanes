<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tulipanes Nocturnos Suaves - 5 Flores Más Juntas</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background: #000;
        }
        canvas { display: block; }
        .overlay {
            position: fixed;
            inset: 0;
            pointer-events: none;
            background: repeating-linear-gradient(135deg, transparent 0 2px, rgba(255,255,255,0.006) 2px 5px);
            z-index: 2;
        }
    </style>
</head>
<body>
    <div class="overlay"></div>
    <canvas id="c"></canvas>

    <script>
        const canvas = document.getElementById('c');
        const ctx = canvas.getContext('2d');

        let w, h, time = 0;
        const flowers = [];
        let particles = [];

        function resize() {
            w = canvas.width = window.innerWidth;
            h = canvas.height = window.innerHeight;
        }

        class Particle {
            constructor() { this.reset(); }
            reset() {
                this.x = Math.random() * w;
                this.y = h + 20;
                this.size = 1.5 + Math.random() * 2.5;
                this.color = Math.random() > 0.4 ? '#fff9d4' : '#ffffff';
                this.speed = 0.4 + Math.random() * 0.7;
                this.drift = (Math.random() - 0.5) * 0.8;
                this.opacity = 0;
                this.pulse = Math.random() * Math.PI * 2;
            }
            update() {
                this.y -= this.speed;
                this.x += this.drift;
                this.opacity = Math.sin(time * 0.003 + this.pulse) * 0.4 + 0.45;
                if (this.y < -20) this.reset();
            }
            draw() {
                ctx.save();
                ctx.globalAlpha = this.opacity * 0.7;
                ctx.shadowBlur = 6;
                ctx.shadowColor = this.color;
                ctx.fillStyle = this.color;
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
                ctx.fill();
                ctx.restore();
            }
        }

        class Tulip {
            constructor(sideOffset, heightRatio, tiltDeg, phase) {
                this.sideOffset = sideOffset;
                this.baseY = h * 0.92;
                this.height = h * heightRatio;
                this.tiltRad = tiltDeg * Math.PI / 180;
                this.phase = phase;
                this.baseX = w / 2;

                this.petalGradient = ctx.createRadialGradient(0, -30, 5, 0, -80, 60);
                this.petalGradient.addColorStop(0, '#ffccdd');
                this.petalGradient.addColorStop(0.4, '#ff9bc2');
                this.petalGradient.addColorStop(0.7, '#ff78a8');
                this.petalGradient.addColorStop(1, '#f06292');
            }

            update() {
                this.angle = this.tiltRad + Math.sin(time * 0.0008 + this.phase) * 0.08;
            }

            draw() {
                const horizontalReach = this.height * 0.48;
                const endX = this.baseX + this.sideOffset + Math.sin(this.angle) * horizontalReach;
                const endY = this.baseY - Math.cos(this.angle) * this.height;

                // Stem
                ctx.beginPath();
                ctx.moveTo(this.baseX, this.baseY);
                ctx.quadraticCurveTo(
                    this.baseX + this.sideOffset * 0.4 + Math.sin(this.angle + 0.3) * this.height * 0.22,
                    this.baseY - Math.cos(this.angle + 0.3) * this.height * 0.38,
                    endX, endY
                );
                const stemGrad = ctx.createLinearGradient(this.baseX, this.baseY, endX, endY);
                stemGrad.addColorStop(0, '#2e6b2e');
                stemGrad.addColorStop(0.6, '#3a7e3a');
                stemGrad.addColorStop(1, '#4a9c4a');
                ctx.strokeStyle = stemGrad;
                ctx.lineWidth = 5.5;
                ctx.lineCap = 'round';
                ctx.stroke();

                // Leaves
                const drawLeaf = (pos, scale, rotOffset, flip) => {
                    const lx = this.baseX + (endX - this.baseX) * pos;
                    const ly = this.baseY + (endY - this.baseY) * pos;
                    ctx.save();
                    ctx.translate(lx, ly);
                    ctx.rotate(this.angle + rotOffset + Math.sin(time * 0.001 + this.phase + pos * 5) * 0.15);
                    if (flip) ctx.scale(-1, 1);
                    ctx.beginPath();
                    ctx.ellipse(0, 0, 28 * scale, 11 * scale, 0, 0, Math.PI * 2);
                    ctx.fillStyle = '#255c25';
                    ctx.globalAlpha = 0.85;
                    ctx.fill();
                    ctx.restore();
                };
                drawLeaf(0.38, 1.15, 0.45, false);
                drawLeaf(0.62, 1.0, -0.4, true);
                drawLeaf(0.80, 0.9, 0.35, false);

                // Petals
                ctx.save();
                ctx.translate(endX, endY);
                ctx.rotate(this.angle * 0.6);

                const drawPetal = (dx, dy, sx, sy, rot, alpha = 0.95, back = false) => {
                    ctx.save();
                    ctx.translate(dx, dy);
                    ctx.rotate(rot);
                    ctx.scale(sx, sy);
                    ctx.beginPath();
                    ctx.moveTo(0, 0);
                    ctx.bezierCurveTo(-18, -25, -32, -55, 0, -85);
                    ctx.bezierCurveTo(32, -55, 18, -25, 0, 0);
                    ctx.closePath();
                    ctx.fillStyle = this.petalGradient;
                    ctx.globalAlpha = back ? 0.70 : alpha;
                    ctx.shadowBlur = back ? 0 : 8;
                    ctx.shadowColor = '#ffffff44';
                    ctx.fill();
                    if (!back) {
                        ctx.globalAlpha = 0.25;
                        ctx.fillStyle = '#ffffff';
                        ctx.fill();
                    }
                    ctx.restore();
                };

                drawPetal(-8, 8, 1.05, 1.05, -0.12, 0.92, true);
                drawPetal(8, 8, 1.05, 1.05, 0.12, 0.92, true);
                drawPetal(-14, -4, 1.0, 1.0, -0.06, 0.90);
                drawPetal(14, -4, 1.0, 1.0, 0.06, 0.90);
                drawPetal(0, -12, 1.08, 1.12, 0, 0.98);

                ctx.restore();
            }
        }

        function init() {
            resize();
            particles = Array.from({length: 70}, () => new Particle());
            flowers.length = 0;

            // 5 tulipanes con MENOS separación (offsets reducidos ~50%)
            flowers.push(new Tulip(-w * 0.09, 0.50, -22, 0.0));   // izquierda más externa
            flowers.push(new Tulip(-w * 0.045, 0.54, -10, 1.1));  // izquierda media
            flowers.push(new Tulip(0,          0.65,   0, 2.2));  // centro (el más alto)
            flowers.push(new Tulip( w * 0.045, 0.54,  10, 3.3));  // derecha media
            flowers.push(new Tulip( w * 0.09,  0.50,  22, 4.4));  // derecha más externa
        }

        function animate() {
            time += 16;
            ctx.clearRect(0, 0, w, h);

            particles.forEach(p => { p.update(); p.draw(); });

            flowers.sort((a, b) => a.sideOffset - b.sideOffset);
            flowers.forEach(f => {
                f.update();
                f.draw();
            });

            requestAnimationFrame(animate);
        }

        window.addEventListener('resize', () => {
            resize();
            init();
        });

        init();
        animate();
    </script>
</body>
</html>